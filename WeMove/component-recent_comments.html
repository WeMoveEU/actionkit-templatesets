<div data-wm-recent-comments class="recent-comments hidden my-8 lg:mx-4 max-w-[500px] mx-auto">
  <h4 class="text-wm-purple mb-4 text-2xl">Recent comments</h4>
  <div data-wm-recent-comment-text class="bg-wm-lightblue-box text-wm-purple p-6 text-sm">
    <div data-wm-comment-by class="italic text-right font-bold"></div>
    <div data-wm-comment-text></div>
  </div>
</div>

<script>
  window.recentComments = {% report "comments_recent_actions" with 1 as refresh page.id as page_id %};
  // window.recentComments = [["name", "comment"],["Karen", "Ban a substance which has more health impact ramifications for our babies, children and adults than any other urgently "],["jGBmQwypfg", "HahSCPtMk"],["sakina", "lets make our food non-toxic"],["DCmcVoSHR", "XcTgUBeIKGZnQP"],["vyfUNCdhbowsx", "pdrBSOWqLfH"],["pYqGMDhd", "KCSmckvI"],["PSIvXErmYHNsu", "CFnfptATsvD"],["KoeQnyXL", "yHxzlDahRNG"],["vgkxNVZuCtzIDsJ", "UedRZEDfJTBjFS"],["bYrKSRGn", "YMoHTlXZIQrq"],["zxONBFAqprUsRV", "qsTUexlhVYcCiSPp"],["qlDgIYrwKycke", "TDVYCJrnu"],["FwiEcAnhuPV", "hdOpNMgLEaXD"],["rlswVaPgRcIkMSJ", "eNxahJHc"],["rlswVaPgRcIkMSJ", "mhkUGuRWJK"],["dgcmwPKoQ", "XLaIVNdsWSwYrOnv"],["liCoTxGPWnazrdR", "mhCdZMvWR"],["zyogjNvBSGDFk", "UHBOtxvQl"],["BsPIFOKlxwQLCRv", "OvKjayJpIlP"],["hckqvwrFuds", "iMkdPWgNIG"],["MzOrUWJgmXGI", "PTUYBCKzSveOGV"],["RQpWtHKC", "YZqEzxLiG"],["rvYcFWNeZyXSs", "tLQKfcYbqrwFEUZO"],["MdOuBnUohpGfekC", "rbFLavSmUMpyB"],["MAHGoxlQeBOrCKiN", "MeFzgplKJdxnRcP"],["JYxTXjUObHaMqD", "NCTwvObkpBK"],["Rabia", "Ban glyphosite now!"],["YRuLGFWEZwbajm", "QguXzNVit"],["kfIyJToOcGzCKeHP", "JlCZjMXoydRE"],["YJGOHexLCQrp", "oSIPzvQLqyad"],["XYehNpxlb", "mbFTXxniSQDhBEs"],["HuixCJldEG", "hOFKkVuGBayfo"],["taSodOFuGL", "SAzsvegmfkpTBLFy"],["oOSrqDdGwUyZCVem", "LvhHNkcBdj"],["BnrJtIdV", "qplbtxiMD"],["ErzmUuovBGedCgjJ", "TrASzhwDOZIiXslJ"],["CqMbomDxflIpV", "uIQEkRownrFXC"],["MUmgVITvLY", "TClWbdgarUOmF"],["fXWnaUxFNweGMQCt", "qVJuOxvLP"],["greZVtlYdn", "vdyBFwAJQ"],["YIdWcUfiNeZMb", "avrnufmwBxc"],["greZVtlYdn", "kjJlHodAa"],["EdzmHaCYjBZeUsGF", "KfWQAdVsCZzNyi"],["GDNpaHkCuAn", "KWMbArOcmUou"],["ClGyihSBpQFK", "JAfNXzHrEy"],["DaYUEwduAs", "RQhlLiDdwtz"],["DbPBMpIiWmg", "tlVHKPOakhLY"],["ApDEzblrf", "YpOIAsMfQywbkE"],["TsRibfMHIaEUjP", "MyYExSqjXN"],["SiVudnERUlqNbHQ", "ZwhOGFyPIk"],["uWDcFlxQIoZvpTtJ", "tFGDfXnxp"],["qerUgnjGpVfDbCl", "HVLATojv"],["LJdlBGKC", "odHhVRMIJYNDPkE"],["kAsqoxGKycwPzNlL", "zPhWRovJEItqGsg"],["aFBwRGWleyd", "ysijvKqRrP"],["IbQUApNLGaqv", "narWhSJwd"],["NyvQwxeRsDMptVo", "ZoEazXDhPRMwYVk"],["ZAKnhodUvEeIOy", "empwHSBOYjIt"],["tTGXzpsKwjLV", "qWzAiYHbCmOFe"],["CQKWZEHFznkJwfuG", "HMcrbtlz"],["rDCaGsBq", "QBICLKYeDtPsRiNc"],["urMAfZKBI", "sbDKdYMXgfP"],["gSLDAqln", "aOvTWXKM"],["jpDuCJeozA", "vXqROUFxPoz"],["pxszLZWTUaAnki", "zFJULuCORT"],["KYwLRlvqapuJ", "BcukAVfeRh"],["XZInKlPuVyix", "KMcmQOyAHXjn"],["yXasWLJchGBlTk", "pZBqhXuHy"],["GBVevbjJPnKq", "XkJHvBsarRFOlg"],["dsakDqriwVPn", "srLHXDemqyF"],["oXBkcUet", "aYcnbhWz"],["cuhLfUprk", "sgfhIHbo"],["UaPRStwnehAgGOy", "fvwYVDqRzI"],["CNaMwObvXz", "wUxvpErl"],["BCWuTEhL", "SxHTpcZbXq"],["tArjceydOTHlg", "emGzNFxLflbQ"],["UdafDOYurSFVpZG", "sKjyEeMBNLm"],["NgCemGqS", "FWkTXZlUVepni"],["WSPtjmDHsphz", "CQpeEvsHhrJd"],["KXbnsWVUZo", "dRDWbVQyFq"],["AXymdYuG", "YVtOMIzDywQo"],["AXymdYuG", "rnzSwOpluChfBK"],["ShgvePHMBks", "xePlKgdhIRc"],["SRKVMzbDHXJpmY", "SUZCstEKojeaz"],["KjZVCPxrNywsE", "lXJICxmqKObRZV"],["pRUjoWLqP", "LWPtNuZHioEgJXf"],["jxPZQpBOsMo", "wagPylMJsFfTdvOX"],["rstKJZFjubTg", "igWTZBFmy"],["jxPZQpBOsMo", "oTVXdIetL"],["QpVmMsubYT", "mFvpoaJzc"],["OegZaDrcnwGVLX", "YxUzTuVPCd"],["vZJBmPswlhpUySF", "ifVJvNUnFTSwaspR"],["FejCXiSfc", "nbKmSELfAXg"],["oMQyWzvwXr", "jaOheIXwyszgU"],["QgNAHqVzseF", "DvepVaIkbLYOuNxK"],["xXeYZkhJfuEFLm", "fzapDRrSld"],["sIaeGBiWMwxFk", "qZrIxjuVOg"],["VpqmSKyr", "WmnxgJfLjy"],["FyIASYvoeEMsHPdO", "kicIJsEFwp"],["swEMjkZGToSUW", "yjGlncAx"]];

  window.recentComments.shift();

  let currentCommentIndex = 0;
  let recentCommentShown = false;
  const commentsWrapper = document.querySelector("[data-wm-recent-comments]");
  const commentText = commentsWrapper.querySelector(
    "[data-wm-recent-comment-text]"
  );

  const cycleRecentComment = () => {
    $(commentText).fadeOut("slow", () => {
      const comment =
        window.recentComments[
          currentCommentIndex++ % window.recentComments.length
        ];

      commentText.querySelector("[data-wm-comment-by]").innerHTML = comment[0];
      commentText.querySelector("[data-wm-comment-text]").innerHTML =
        comment[1];

      commentText.classList.remove("hidden");
      $(commentText).fadeIn("slow");

      let duration = Math.ceil(comment[1].split(" ").length * 0.2);

      if (duration < 3) {
        duration = 3;
      }

      setTimeout(cycleRecentComment, duration * 1000);
    });
  };

  if (commentText && window.recentComments.length && !recentCommentShown) {
    recentCommentShown = true;
    $(commentsWrapper).fadeIn("slow");
    cycleRecentComment();
  }
</script>
