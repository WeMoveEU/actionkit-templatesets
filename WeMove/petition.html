{% extends "./wrapper.html" %}

{% block content %}

<div class="nav-md:grid grid-cols-petition">

	{% if not isEmbbeded %}
	<article>
		<div class="relative">
			{% include "./language_picker.html" %}
			<h1 class="text-4xl mb-8 pr-40 nav-md:text-5xl">{{ page.title }}</h1>
		</div>

		{% store as featured_video %}{% report "custom_field_from_page_or_campaign" with 1 as refresh page.id as page_id "featured_video" as field_name %}{% endstore %}
		{% store as featured_image %}{% report "custom_field_from_page_or_campaign" with 1 as refresh page.id as page_id "featured_image" as field_name %}{% endstore %}
		{% if featured_video %}
			{% include "./featured-video.html" with featured_video=featured_video %}
		{% elif featured_image %}
			{% include "./featured-image.html" with featured_image=featured_image %}
		{% endif %}

		<div class="mr-4">
			{% if form.statement_leadin %}
				<h3 class="mt-8 italic font-normal text-base font-libre-franklin">
					{% include_tmpl form.statement_leadin %}
				</h3>
			{% endif %}

			{% if page.custom_fields.youmove_initiator_name %}
				<p data-wm-initiator-name="{{ page.custom_fields.youmove_initiator_name }}">
					{% filter ak_text:"statement_initiator" %}This petition is run by [% inititator_name %]{% endfilter %}
				</p>
			{% endif %}

			<div class="text-wm-purple p-6 bg-wm-orangy-box mb-8">
				<h2 class="uppercase border-b-[1px] text-2xl pb-2 border-wm-purple">
					{% filter ak_text:"petition_title" %}Petition{% endfilter %}
				</h2>

				{% include_tmpl form.statement_text %}
			</div>

			<div class="text-wm-purple p-6 bg-wm-lightblue-box mb-8">
				{% if form.about_text %}
				<h2 class="uppercase border-b-[1px] text-2xl pb-2 border-wm-purple">
					{% filter ak_text:"whyIsThisImportant_title" %}Why is this important?{% endfilter %}
				</h2>

				{% include_tmpl form.about_text %}
				{% endif %}

				{% store as references %}{% report "custom_field_from_page_or_campaign" with 1 as refresh page.id as page_id "references" as field_name %}{% endstore %}
				{% if references %}
				<h4 class="border-t-[1px] inline-block text-black pr-4 pt-4 border-wm-purple">
					{% filter ak_text:"references" %}References:{% endfilter %}
				</h4>

				<div class="references text-sm">
					{{ references }}
				</div>
				{% endif %}
			</div>

			{% store as partnership_icons %}{% report "custom_field_from_page_or_campaign" with 1 as refresh page.id as page_id "partnership_icons" as field_name %}{% endstore %}
			{% if partnership_icons %}
			<div class="text-wm-purple mb-8">
				<h3>{% filter ak_text:"in_partnership_with" %}In partnership with:{% endfilter %}</h3>
				{{ partnership_icons }}
			</div>
			{% endif %}

			{% store as supporters_icons %}{% report "custom_field_from_page_or_campaign" with 1 as refresh page.id as page_id "supporters_icons" as field_name %}{% endstore %}
			{% if supporters_icons %}
			<div class="text-wm-purple mb-8">
				<h3>{% filter ak_text:"supported_by" %}Supported by:{% endfilter %}</h3>
				{{ supporters_icons }}
			</div>
			{% endif %}
		</div>

		{% include "./component-recent_actions.html" %}
	</article>
	{% endif %}

	<aside>
		<form
			class="ak-form ak-styled-fields ak-labels-overlaid ak-errs-below {% if not isEmbbeded %}is-floating{% endif %}
				bg-wm-bg-form p-4"
			name="act"
			method="post"
			action="/act/"
			accept-charset="utf-8"
			data-wm-floating-labels-form
			data-wm-form
			data-wm-pixel-event-type="Lead"
			data-wm-pixel-track-type="track"
			data-wm-pixel-content-id="{{ page.id }}"
			data-wm-pixel-content-name="{{ page.title }}"
			data-wm-pixel-trigger-event="submit">

			<input type="hidden" name="page" value="{{ page.name }}">

			<div class="mb-4 h-[88px]">
				<div data-wm-floating-meter class="floating-progress-meter">
					{% include "./component-progress_meter.html" %}

					<a href="#petition-form" class="fake-submit-button">
						{% if page.custom_fields.sign_petition_button %}
							{{ page.custom_fields.sign_petition_button }}
						{% else %}
							{% filter ak_text:"button_sign_petition" %}
								Sign the Petition
							{% endfilter %}
						{% endif %}
					</a>
				</div>
			</div>

			<div
				id="petition-form"
				class="form-wrapper-container"
				data-wm-form-container>

				{% include "./user_form_wrapper.html" %}

				{% store as hide_comments_field %}{% report "custom_field_from_page_or_campaign" with 1 as refresh page.id as page_id "hide_comments_field" as field_name %}{% endstore %}
				{% if not hide_comments_field == "1" %}
				<div class="ak-field form-field hide-if-previously-signed">
					<label for="id_comment">{% filter ak_text:"form_field_comments" %}Your comments:{% endfilter %}</label>
					<textarea id="id_comment" name="action_comment"></textarea>
				</div>
				{% endif %}

				<div data-wm-consent-inline-new-container hidden></div>

				<div class="form-field hide-if-previously-signed mb-4">
					<button type="submit" class="button--primary">
						{% if page.custom_fields.sign_petition_button %}
							{{ page.custom_fields.sign_petition_button }}
						{% else %}
							{% filter ak_text:"button_sign_petition" %}
								Sign the Petition
							{% endfilter %}
						{% endif %}
					</button>
				</div>

				<div class="privacy-statement">
					{% store as consent_text %}{% report "signup_text_for_list_language" with 1 as refresh page.list_id as list_id page.lang_id|default:100 as lang_id %}{% endstore %}
					{{ consent_text }}
				</div>

			</div>
		</form>

		{% if not isEmbbeded %}
			{% include "./component-recent_comments.html" %}
		{% endif %}
	</aside>
</div>

{% endblock %}
