{% extends "./wrapper.html" %}

{% block css_additions %}
{{ block.super }}
{% if page.custom_fields.call_page_mode == "call" %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/intl-tel-input@25.13.2/build/css/intlTelInput.css">
{% endif %}
{% endblock %}

{% block content %}

{% if page.custom_fields.call_page_mode == "call" and action and action.page.id == page.id %}
{% remember 1 as MAKING_CALLS %}
{% endif %}

<div class="{% if not MAKING_CALLS %}nav-md:grid grid-cols-petition{% endif %} mb-8">
  <article {% if MAKING_CALLS %}hidden{% endif %}>
    <h1 class="nav-md:mr-4">{{ page.title }}</h1>

    {% include "./component-featured_media.html" %}

    <div class="mt-4 nav-md:mr-4">
      {% include_tmpl form.introduction_text %}
    </div>
  </article>

  <aside>
    <form
      class="ak-form ak-styled-fields ak-labels-overlaid ak-errs-below p-4 mx-auto {% if not MAKING_CALLS %}bg-wm-bg-form max-w-[500px]{% endif %}"
      name="act"
      method="post"
      action="/act/">

      <input type="hidden" name="page" value="{{ page.name }}">

      {% if page.custom_fields.call_page_mode == 'tweet' %}
        {% include "./component-call_page-tweet.html" %}
      {% elif page.custom_fields.call_page_mode == 'facebook' %}
        {% include "./component-call_page-facebook.html" %}
      {% elif page.custom_fields.call_page_mode == 'call' and not MAKING_CALLS %}
        {% include "./component-call_page-call.html" %}
      {% elif page.custom_fields.call_page_mode == 'call' and MAKING_CALLS %}
        {% include "./component-call_page-call-progress.html" %}
      {% endif %}
    </form>
  </aside>
</div>

{% endblock %}